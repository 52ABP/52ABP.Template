(function(n){function o(n,t){abp.message.confirm(abp.utils.formatString(u("AreYouSureWantToDelete"),t),null,t=>{t&&f.delete({id:n}).done(()=>{abp.notify.info(u("SuccessfullyDeleted")),r.ajax.reload()})})}var f=abp.services.app.role,u=abp.localization.getSource("YoyoCmsTemplate"),t=n("#RoleCreateModal"),i=t.find("form"),e=n("#RolesTable"),r=e.DataTable({paging:!0,serverSide:!0,ajax:function(t,i){var r=n("#RolesSearchForm").serializeFormToObject(!0);r.maxResultCount=t.length;r.skipCount=t.start;abp.ui.setBusy(e);f.getAll(r).done(function(n){i({recordsTotal:n.totalCount,recordsFiltered:n.totalCount,data:n.items})}).always(function(){abp.ui.clearBusy(e)})},buttons:[{name:"refresh",text:'<i class="fas fa-redo-alt"><\/i>',action:()=>r.draw(!1)}],responsive:{details:{type:"column"}},columnDefs:[{targets:0,className:"control",defaultContent:""},{targets:1,data:"name",sortable:!1},{targets:2,data:"displayName",sortable:!1},{targets:3,data:null,sortable:!1,autoWidth:!1,defaultContent:"",render:(n,t,i)=>[`   <button type="button" class="btn btn-sm bg-secondary edit-role" data-role-id="${i.id}" data-toggle="modal" data-target="#RoleEditModal">`,`       <i class="fas fa-pencil-alt"></i> ${u("Edit")}`,"   <\/button>",`   <button type="button" class="btn btn-sm bg-danger delete-role" data-role-id="${i.id}" data-role-name="${i.name}">`,`       <i class="fas fa-trash"></i> ${u("Delete")}`,"   <\/button>",].join("")}]});i.find(".save-button").on("click",e=>{var o,s,h,c;if(e.preventDefault(),i.valid()){if(o=i.serializeFormToObject(),o.grantedPermissions=[],s=i[0].querySelectorAll("input[name='permission']:checked"),s)for(h=0;h<s.length;h++)c=n(s[h]),o.grantedPermissions.push(c.val());console.log(o);abp.ui.setBusy(t);f.create(o).done(function(){t.modal("hide");i[0].reset();abp.notify.info(u("SavedSuccessfully"));r.ajax.reload()}).always(function(){abp.ui.clearBusy(t)})}});n(document).on("click",".delete-role",function(){var t=n(this).attr("data-role-id"),i=n(this).attr("data-role-name");o(t,i)});n(document).on("click",".edit-role",function(t){var i=n(this).attr("data-role-id");t.preventDefault();abp.ajax({url:abp.appPath+"Roles/EditModal?roleId="+i,type:"POST",dataType:"html",success:function(t){n("#RoleEditModal div.modal-content").html(t)},error:function(){}})});abp.event.on("role.edited",()=>{r.ajax.reload()});t.on("shown.bs.modal",()=>{t.find("input:not([type=hidden]):first").focus()}).on("hidden.bs.modal",()=>{i.clearForm()});n(".btn-search").on("click",()=>{r.ajax.reload()});n(".txt-search").on("keypress",n=>{if(n.which==13)return r.ajax.reload(),!1})})(jQuery);